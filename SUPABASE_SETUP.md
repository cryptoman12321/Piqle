# Настройка Supabase для Piqle

## Шаг 1: Создание проекта на Supabase

1. Перейдите на [supabase.com](https://supabase.com)
2. Создайте аккаунт или войдите в существующий
3. Нажмите "New Project"
4. Выберите организацию
5. Введите название проекта: `piqle-tournaments`
6. Выберите пароль для базы данных
7. Выберите регион (ближайший к вам)
8. Нажмите "Create new project"

## Шаг 2: Получение ключей

После создания проекта:

1. Перейдите в **Settings** → **API**
2. Скопируйте:
   - **Project URL** (например: `https://abcdefghijklmnop.supabase.co`)
   - **anon public** ключ

## Шаг 3: Настройка переменных окружения

Создайте файл `.env` в корне проекта:

```bash
# Supabase Configuration
EXPO_PUBLIC_SUPABASE_URL=https://your-project-id.supabase.co
EXPO_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here
```

## Шаг 4: Создание базы данных

1. Перейдите в **SQL Editor** в панели Supabase
2. Скопируйте содержимое файла `supabase-schema.sql`
3. Вставьте в SQL Editor и нажмите "Run"

## Шаг 5: Настройка аутентификации

1. Перейдите в **Authentication** → **Settings**
2. Включите **Email confirmations** (опционально)
3. Настройте **Site URL** (для веб-версии)

## Шаг 6: Тестирование подключения

Запустите приложение и проверьте:

1. **Создание турнира** - должно сохраниться в базе
2. **Добавление игроков** - должно работать
3. **Создание матчей** - должно генерироваться автоматически

## Структура базы данных

### Таблицы:
- **users** - пользователи системы
- **tournaments** - турниры
- **tournament_players** - участники турниров
- **matches** - матчи

### Представления:
- **tournament_standings** - турнирная таблица

### Функции:
- **generate_round_robin_matches()** - генерация матчей

## Безопасность

Все таблицы защищены **Row Level Security (RLS)**:
- Пользователи могут видеть все турниры
- Создавать турниры могут только авторизованные пользователи
- Редактировать турниры могут только их создатели
- Управлять игроками могут только создатели турниров

## Troubleshooting

### Ошибка "Invalid API key"
- Проверьте правильность URL и ключа
- Убедитесь, что ключ скопирован полностью

### Ошибка "Table does not exist"
- Проверьте, что SQL скрипт выполнился успешно
- Проверьте логи в SQL Editor

### Проблемы с аутентификацией
- Проверьте настройки в Authentication → Settings
- Убедитесь, что RLS включен для всех таблиц

## Следующие шаги

После успешной настройки:
1. Интегрируйте Supabase в компоненты приложения
2. Добавьте real-time подписки для live обновлений
3. Настройте push-уведомления
4. Добавьте аналитику и мониторинг
